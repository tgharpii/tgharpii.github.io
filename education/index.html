<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script src="https://aframe.io/releases/1.7.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.2.0/dist/aframe-extras.min.js"></script>
</head>

  <body>
    <a-scene 
      vr-mode-ui="enabled: false"
      arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false;">
      
      <a-assets>
        <a-asset-item id="main" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_Elder.gltf"></a-asset-item>
        <a-asset-item id="CopyCube" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_CopyCube.gltf"></a-asset-item>
        <a-asset-item id="bookA" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_BookA.gltf"></a-asset-item>
        <a-asset-item id="bookB" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_BookB.gltf"></a-asset-item>
        <a-asset-item id="bookC" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_BookC.gltf"></a-asset-item>
        <a-asset-item id="bookD" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_BookD.gltf"></a-asset-item>
        <a-asset-item id="bookE" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/BSN_Education_Ani_BookE.gltf"></a-asset-item>
        <a-asset-item id="joinButton" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/joinButton.gltf"></a-asset-item>
        <a-asset-item id="nextButton" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/nextButton.gltf"></a-asset-item>
        <a-asset-item id="findButton" src="https://cdn.jsdelivr.net/gh/BlackSustainabilityNetwork/BSN@1be22cf9e3d1d7f8e952edd11ba5ac49595e9769/education/Assets/findButton.gltf"></a-asset-item>

      </a-assets>

      <a-camera rotation-reader position="0 0 0" look-controls raycaster="objects: .clickable" cursor="rayOrigin: mouse;"></a-camera>

      <a-entity>
        <a-gltf-model 
          id="mainEntity"
          rotation="0 0 0" 
          position="0 -9 -20" 
          scale="0 0 0" 
          src="#main"
          animation-mixer="clip: ElderFloat; loop: true; true; timeScale:0.5;"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="bookAEntity"
          rotation="0 0 0" 
          position="0 -9 -21" 
          scale="0 0 0" 
          src="#bookA"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
        id="CopyCubeEntity"
        rotation="0 0 0" 
        position="-1.5 -9 -22.5" 
        scale="0 0 0" 
        src="#CopyCube"
        animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
      </a-gltf-model>

        <a-gltf-model 
          id="bookBEntity"
          rotation="0 0 0" 
          position="0 -9 -22" 
          scale="0 0 0" 
          src="#bookB"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="bookCEntity"
          rotation="0 0 0" 
          position="0 -9 -22" 
          scale="0 0 0" 
          src="#bookC"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="bookDEntity"
          rotation="0 0 0" 
          position="0 -9 -21" 
          scale="0 0 0" 
          src="#bookD"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="bookEEntity"
          rotation="0 0 0" 
          position="0 -9 -21" 
          scale="0 0 0" 
          src="#bookE"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="NextButtonEntity"
          class="clickable"
          rotation="0 0 0" 
          position="-15.5 -7 -14" 
          scale="0 0 0" 
          src="#nextButton"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="joinButtonEntity"
          class="clickable"
          rotation="0 0 0" 
          position="-25.5 -9.5 -14" 
          scale="0 0 0" 
          src="#joinButton"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

        <a-gltf-model 
          id="FindButtonEntity"
          class="clickable"
          rotation="0 0 0" 
          position="-39 -12 -14" 
          scale="0 0 0" 
          src="#findButton"
          animation__fadein="property: scale; to: 1 1 1; dur: 1000; easing: easeOutCubic; startEvents: model-loaded">
        </a-gltf-model>

      </a-entity>
    </a-scene>

    <script>
      // Wait for scene to load before attaching listener
      document.addEventListener('DOMContentLoaded', () => {
        const CopyCubeEntity = document.querySelector('#CopyCubeEntity');  // Reference to the avatar model
        const joinButtonEntity = document.querySelector('#joinButtonEntity');
        const nextButtonEntity = document.querySelector('#NextButtonEntity');
        const FindButtonEntity = document.querySelector('#FindButtonEntity');
        const FarmerStatEntity = document.querySelector('#FarmerStatEntity');

        const animations = ['CopyCubeLoop', 'CopyCube1', 'CopyCube2', 'CopyCube3'];
        let currentClipIndex = 0;

        CopyCubeEntity.setAttribute('animation-mixer', `clip: ${animations[currentClipIndex]}; loop: once; timeScale: 1; clampWhenFinished: true;`);

        nextButtonEntity.addEventListener('click', () => {
          // Move to the next animation
          currentClipIndex = (currentClipIndex + 1) % animations.length;
          const currentClip = animations[currentClipIndex];

          // Set the new animation-mixer with clampWhenFinished: true
          CopyCubeEntity.setAttribute('animation-mixer', `clip: ${currentClip}; loop: once; clampWhenFinished: True; timeScale: 1;`);

        });

      
        joinButtonEntity.addEventListener('click', () => {
            window.open("https://www.blacksustainability.org/join-our-network?utm_source=Cultural+Education&utm_medium=AR&utm_campaign=Join+our+network", "_blank");
        });

        FindButtonEntity.addEventListener('click', () => {
            window.open("https://maps.blacksustainability.org/?utm_source=Cultural+Preservation+and+Education&utm_medium=AR&utm_campaign=BSN+map", "_blank");
        });
      });

    </script>
  </body>
</html>
